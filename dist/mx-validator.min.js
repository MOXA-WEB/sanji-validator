!function(){"use strict";angular.module("mx.validator.value",[]).value("_",window._)}(),function(){"use strict";angular.module("mx.validator.provider",["mx.validator.value"]).provider("mxValidatorConfig",function(){var r,e,t,o,a,i,n,l;r=this,e={},e.validators={},e.validMethod="watch",t=function(r){o=r,i=o.get("$q"),n=o.get("$timeout"),a=o.get("$rootScope"),l=o.get("_")},r.isReservedRule=function(r){return-1!==["range"].indexOf(r)},r.extractVarFromFunc=function(r){var e,t;return e=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,t=r.toString().match(e)[1].split(/,/),t=l.map(t,function(r){return r.replace(/^\s+|\s+$/g,"")})},r.runReservedRule=function(e,t,o){var a,i;return i={},a=r.extractVarFromFunc(e),i.value=t,l.each(o,function(r,e){return"value"===e?!0:void(-1!==a.indexOf(e)&&(i[e]=r))}),e.apply(this,l.pluck(i))},r.setValidMethod=function(r){e.validMethod=r},r.getValidMethod=function(){return e.validMethod},r.setValidators=function(r){angular.extend(e.validators,r),a.$broadcast("mx::validators::change")},r.getValidators=function(){return e.validators},r.getValidatorsByNames=function(e){var t,o;return t=r.getValidators(),o=[],l.each(e,function(r){var e;if(r=r.replace(/^\s+|\s+$/g,""),e=t[r],!e)throw new Error("validator "+r+" not found.");e.name=r,o.push(e)}),o},r.setCustomErrorHtml=function(r){e.customCustomErrorHtml=r},r.getCustomErrorHtml=function(){return e.customCustomErrorHtml},r.getErrorHtml=function(r){return'<p class="validation-invalid">'+r+"</p>"},r.isRegExp=function(r){return RegExp===r.constructor},r.validate=function(r,e){e.hasSetFocus=!1;for(var t in e)e[t]&&e[t].hasOwnProperty("$dirty")&&r.$broadcast(t+"::mx-submit");var o=i.defer();return n(function(){e.$valid?o.resolve("success"):o.reject("error")}),o.promise},r.useBlur=function(e){return e&&angular.isDefined(e.validatorMethod)?"blur"===e.validatorMethod:"blur"===r.getValidMethod()},r.useSubmit=function(e){return e&&angular.isDefined(e.validatorMethod)?"submit"===e.validatorMethod:"submit"===r.getValidMethod()},r.$get=["$injector",function(e){return t(e),{getCustomErrorHtml:r.getCustomErrorHtml,getErrorHtml:r.getErrorHtml,getValidMethod:r.getValidMethod,getValidators:r.getValidators,getValidatorsByNames:r.getValidatorsByNames,isRegExp:r.isRegExp,isReservedRule:r.isReservedRule,runReservedRule:r.runReservedRule,setCustomErrorHtml:r.setCustomErrorHtml,setValidMethod:r.setValidMethod,setValidators:r.setValidators,useBlur:r.useBlur,useSubmit:r.useSubmit,validate:r.validate}}]})}(),function(){"use strict";angular.module("mx.validator.directive",["mx.validator.provider"]).directive("mxValidatorSubmit",["mxValidatorConfig",function(r){return{priority:-1,restrict:"A",require:["form","?mxValidatorMethod"],link:function(e,t,o,a){var i,n;i=a[0],n=a[1],t.on("submit",function(t){(r.useBlur(n)||r.useSubmit(n))&&(t.stopImmediatePropagation(),r.validate(e,i).then(function(){e.$eval(o.ngSubmit)}))})}}}]).directive("mxValidatorNoErrorMsg",function(){return{restrict:"A",require:"form",controller:["$scope",function(){}]}}).directive("mxValidatorMethod",function(){return{restrict:"A",require:"form",scope:{mxValidatorMethod:"@"},controller:["$scope",function(r){this.validatorMethod=r.mxValidatorMethod}]}}).directive("mxValidator",["mxValidatorConfig","$interpolate","$compile","_","$timeout",function(r,e,t,o,a){var i,n,l,u,s;return s={},i=function(e,t,a,i){var n,l;return n=!1,o.each(t,function(t){var o,a;return o=t.rule,a=!!e,"required"===t.name?n=!a:a?r.isReservedRule(t.name)?n=!r.runReservedRule(o,e,i):angular.isFunction(o)?n=!o(e):r.isRegExp(o)&&(n=!o.test(e)):n=!1,n?(l=t,!1):void 0}),a.$setValidity(a.$name,!n),{error:n,errorValidator:l}},n=function(o,i,n,l){if(angular.isString(l.beforeElementSelector)&&(o=o.closest(l.beforeElementSelector)),i.error){var d=i.errorValidator.error;if(r.isReservedRule(i.errorValidator.name)){var c=e(i.errorValidator.error);d=c(n)}var m=r.getCustomErrorHtml();if(!m)return o.next().html(r.getErrorHtml(d));var v=l.scope.$id+o.attr("name");s[v]&&s[v].$destroy(),u=l.scope.$new(),s[v]=u,u.errorMessage=d,a(function(){o.next().html(t(m)(u))})}return o.next().html("")},l=function(r,e,t){r?t.invalidCallback({errorValidator:e}):t.validCallback()},{restrict:"A",require:["ngModel","?^mxValidatorMethod","?^mxValidatorNoErrorMsg","^form"],scope:{ngModel:"=",validCallback:"&",invalidCallback:"&",beforeElementSelector:"@"},link:function(e,t,o,a){angular.isString(e.beforeElementSelector)?t.closest(e.beforeElementSelector).after("<span></span>"):t.after("<span></span>");var u,s,d,c,m,v,f,g;return c=a[0],m=a[1],f=a[2],g=a[3],u=o.mxValidator.split(","),s=r.getValidatorsByNames(u),c.$setValidity(c.$name,!0),v={},v.beforeElementSelector=e.beforeElementSelector,v.scope=e,e.$on("mx::validators::change",function(){s=r.getValidatorsByNames(u)}),e.$on(c.$name+"::mx-submit",function(){var r=i(t[0].value,s,c,o);angular.isDefined(f)||n(t,r,o,v),l(r.error,r.errorValidator,e),r.error&&!1===g.hasSetFocus&&(t[0].focus(),g.hasSetFocus=!0)}),r.useSubmit(m)?void 0:(d=function(){t.bind("blur",function(){e.$apply(function(){var r=i(t[0].value,s,c,o);angular.isDefined(f)||n(t,r,o,v),l(r.error,r.errorValidator,e)})})},r.useBlur(m)?void d():void e.$watch("ngModel",function(r){c.$pristine&&c.$viewValue&&c.$setViewValue(c.$viewValue);var a=i(r,s,c,o);angular.isDefined(f)||n(t,a,o,v),l(a.error,a.errorValidator,e)}))}}}])}(),function(){"use strict";angular.module("mx.validator",["mx.validator.value","mx.validator.provider","mx.validator.directive"])}();
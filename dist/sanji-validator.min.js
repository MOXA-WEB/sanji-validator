!function(){"use strict";angular.module("sanji.validator.value",[]).value("_",window._)}(),function(){"use strict";angular.module("sanji.validator.provider",["sanji.validator.value"]).provider("sanjiValidatorConfig",function(){var r,e,t,a,i,o,n,l;r=this,e={},e.validators={},e.validMethod="watch",t=function(r){a=r,o=a.get("$q"),n=a.get("$timeout"),i=a.get("$rootScope"),l=a.get("_")},r.isReservedRule=function(r){return-1!==["range"].indexOf(r)},r.extractVarFromFunc=function(r){var e,t;return e=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,t=r.toString().match(e)[1].split(/,/),t=l.map(t,function(r){return r.replace(/^\s+|\s+$/g,"")})},r.runReservedRule=function(e,t,a){var i,o;return o={},i=r.extractVarFromFunc(e),o.value=t,l.each(a,function(r,e){return"value"===e?!0:void(-1!==i.indexOf(e)&&(o[e]=r))}),e.apply(this,l.pluck(o))},r.setValidMethod=function(r){e.validMethod=r},r.getValidMethod=function(){return e.validMethod},r.setValidators=function(r){angular.extend(e.validators,r),i.$broadcast("sanji::validators::change")},r.getValidators=function(){return e.validators},r.getValidatorsByNames=function(e){var t,a;return t=r.getValidators(),a=[],l.each(e,function(r){var e;if(r=r.replace(/^\s+|\s+$/g,""),e=t[r],!e)throw new Error("validator "+r+" not found.");e.name=r,a.push(e)}),a},r.setCustomErrorHtml=function(r){e.customCustomErrorHtml=r},r.getCustomErrorHtml=function(){return e.customCustomErrorHtml},r.getErrorHtml=function(r){return'<p class="validation-invalid">'+r+"</p>"},r.isRegExp=function(r){return RegExp===r.constructor},r.validate=function(r,e){e.hasSetFocus=!1;for(var t in e)e[t]&&e[t].hasOwnProperty("$dirty")&&r.$broadcast(t+"::sanji-submit");var a=o.defer();return n(function(){e.$valid?a.resolve("success"):a.reject("error")}),a.promise},r.useBlur=function(e){return e&&angular.isDefined(e.validatorMethod)?"blur"===e.validatorMethod:"blur"===r.getValidMethod()},r.useSubmit=function(e){return e&&angular.isDefined(e.validatorMethod)?"submit"===e.validatorMethod:"submit"===r.getValidMethod()},r.$get=["$injector",function(e){return t(e),{getCustomErrorHtml:r.getCustomErrorHtml,getErrorHtml:r.getErrorHtml,getValidMethod:r.getValidMethod,getValidators:r.getValidators,getValidatorsByNames:r.getValidatorsByNames,isRegExp:r.isRegExp,isReservedRule:r.isReservedRule,runReservedRule:r.runReservedRule,setCustomErrorHtml:r.setCustomErrorHtml,setValidMethod:r.setValidMethod,setValidators:r.setValidators,useBlur:r.useBlur,useSubmit:r.useSubmit,validate:r.validate}}]})}(),function(){"use strict";angular.module("sanji.validator.directive",["sanji.validator.provider"]).directive("sanjiValidatorSubmit",["sanjiValidatorConfig",function(r){return{priority:-1,restrict:"A",require:["form","?sanjiValidatorMethod"],link:function(e,t,a,i){var o,n;o=i[0],n=i[1],t.on("submit",function(t){(r.useBlur(n)||r.useSubmit(n))&&(t.stopImmediatePropagation(),r.validate(e,o).then(function(){e.$eval(a.ngSubmit)}))})}}}]).directive("sanjiValidatorNoErrorMsg",function(){return{restrict:"A",require:"form",controller:["$scope",function(){}]}}).directive("sanjiValidatorMethod",function(){return{restrict:"A",require:"form",scope:{sanjiValidatorMethod:"@"},controller:["$scope",function(r){this.validatorMethod=r.sanjiValidatorMethod}]}}).directive("sanjiValidator",["sanjiValidatorConfig","$interpolate","$compile","_","$timeout",function(r,e,t,a,i){var o,n,l,u,s;return s={},o=function(e,t,i,o){var n,l;return n=!1,a.each(t,function(t){var a,i;return a=t.rule,i=!!e,"required"===t.name?n=!i:i?r.isReservedRule(t.name)?n=!r.runReservedRule(a,e,o):angular.isFunction(a)?n=!a(e):r.isRegExp(a)&&(n=!a.test(e)):n=!1,n?(l=t,!1):void 0}),i.$setValidity(i.$name,!n),{error:n,errorValidator:l}},n=function(a,o,n,l){if(angular.isString(l.beforeElementSelector)&&(a=a.closest(l.beforeElementSelector)),o.error){var d=o.errorValidator.error;if(r.isReservedRule(o.errorValidator.name)){var c=e(o.errorValidator.error);d=c(n)}var v=r.getCustomErrorHtml();if(!v)return a.next().html(r.getErrorHtml(d));var f=l.scope.$id+a.attr("name");s[f]&&s[f].$destroy(),u=l.scope.$new(),s[f]=u,u.errorMessage=d,i(function(){a.next().html(t(v)(u))})}return a.next().html("")},l=function(r,e,t){r?t.invalidCallback({errorValidator:e}):t.validCallback()},{restrict:"A",require:["ngModel","?^sanjiValidatorMethod","?^sanjiValidatorNoErrorMsg","^form"],scope:{ngModel:"=",validCallback:"&",invalidCallback:"&",beforeElementSelector:"@"},link:function(e,t,a,i){angular.isString(e.beforeElementSelector)?t.closest(e.beforeElementSelector).after("<span></span>"):t.after("<span></span>");var u,s,d,c,v,f,m,g;return c=i[0],v=i[1],m=i[2],g=i[3],u=a.sanjiValidator.split(","),s=r.getValidatorsByNames(u),c.$setValidity(c.$name,!0),f={},f.beforeElementSelector=e.beforeElementSelector,f.scope=e,e.$on("sanji::validators::change",function(){s=r.getValidatorsByNames(u)}),e.$on(c.$name+"::sanji-submit",function(){var r=o(t[0].value,s,c,a);angular.isDefined(m)||n(t,r,a,f),l(r.error,r.errorValidator,e),r.error&&!1===g.hasSetFocus&&(t[0].focus(),g.hasSetFocus=!0)}),r.useSubmit(v)?void 0:(d=function(){t.bind("blur",function(){e.$apply(function(){var r=o(t[0].value,s,c,a);angular.isDefined(m)||n(t,r,a,f),l(r.error,r.errorValidator,e)})})},r.useBlur(v)?void d():void e.$watch("ngModel",function(r){c.$pristine&&c.$viewValue&&c.$setViewValue(c.$viewValue);var i=o(r,s,c,a);angular.isDefined(m)||n(t,i,a,f),l(i.error,i.errorValidator,e)}))}}}])}(),function(){"use strict";angular.module("sanji.validator",["sanji.validator.value","sanji.validator.provider","sanji.validator.directive"])}();